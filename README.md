# [🛍️ Com.On: 감성 기반 AI 쇼핑 추천 플랫폼](https://com-on.onrender.com/)

Com.On은 사용자의 자연어 질의를 기반으로 감성적이며 직관적인 쇼핑 추천을 제공하는 AI 기반 웹 서비스입니다. GPT-4를 활용해 단순 검색을 넘어서, 진짜 '조건에 맞는' 제품을 정리된 카드 형태로 제공합니다.

---

## 📌 주요 기능

### 🔍 1. 자연어 기반 쇼핑 질의
- 사용자의 요구를 대화형 인터페이스로 수집
- GPT-4를 통해 조건 분석 및 요약

### 🎯 2. 제품 추천
- `products.json`에 기반한 사전 추천
- 실시간으로 누락된 제품은 n8n Webhook을 통해 GPT 호출 및 보완
- 네이버 쇼핑 API로 가격 및 링크 자동 조회

### 🧠 3. 이어 대화 추천
- 챗봇 UI에서 조건 보완형 질문 제시
- 대화 이력을 바탕으로 `final_keywords` 추출 → 최종 검색

### 📈 4. 사용자 행동 로깅
- 클릭, 검색 이동, 이벤트 발생 등 로깅
- UUID 기반 식별자 쿠키로 사용자 추적

### 🌐 5. SEO 및 SNS 공유 최적화
- OG 태그, Twitter 카드, robots.txt, sitemap.xml 구성

---

## 📁 디렉토리 구조

```bash
📦 project-root/
├── app.py                       # Flask 서버 진입점
├── static/
│   ├── css/                     # 스타일 시트들 (style.css, chat.css 등)
│   ├── js/                      # 클라이언트 JS (result.js, logger.js 등)
│   └── data-json/              # 📁 JSON 데이터 폴더
│       ├── products.json       # 추천 제품 데이터
│       └── questions.json      # 사용자 질의 샘플
│       └── readme.md           # json 데이터 구조 설명
├── templates/
│   ├── index.html              # 메인 페이지
│   ├── result.html             # 추천 결과 페이지
│   └── 404.html                # 커스텀 오류 페이지
├── public/
│   ├── sitemap.xml             # SEO용 사이트맵
│   └── robots.txt              # 크롤링 설정
├── .env                        # 환경 변수 설정 (OpenAI, Naver API 키 등)
└── README.md                   # 프로젝트 설명 문서
```

---

## ⚙️ 환경 설정 및 실행 방법

1. `.env` 파일 생성
```bash
OPENAI_API_KEY=your_openai_api_key
NAVER_API_CLIENT_ID=your_client_id
NAVER_API_CLIENT_SECRET=your_client_secret
```

2. 필요한 패키지 설치
```bash
pip install flask openai python-dotenv requests googlesearch-python
```

3. 서버 실행
```bash
python app.py
```

4. 로컬 접속
```
http://localhost:5000
```

---

## 💬 주요 엔드포인트 요약

| 경로 | 설명 |
|------|------|
| `/` | 메인 페이지 렌더링 |
| `/search` | 추천 결과 페이지 렌더링 |
| `/api/questions` | 질의 샘플 리스트(JSON) |
| `/api/products` | 추천 제품 결과(JSON, 없을 경우 n8n Webhook 통해 동적 생성) |
| `/api/get_price` | 네이버 API로 가격/링크 조회 |
| `/chat` | 대화형 추천 응답 처리 (GPT-4o-mini 연동) |
| `/log/click` | 제품 클릭 이벤트 로깅 |
| `/log/event` | 일반 이벤트 로깅 |
| `/robots.txt`, `/sitemap.xml` | SEO 대응 |

---

## 🧪 향후 확장 계획

- [ ] 사용자 계정/히스토리 기반 개인화 추천
- [ ] 관리자용 대시보드 (조회수, 클릭률, 전환률)
- [ ] 실시간 트렌드 분석 기반 추천
- [ ] Whisper 기반 음성 질의 추천
- [ ] GPT-4o-mini 도입 (멀티모달 응답 포함)
- [ ] 파트너 제휴 링크 시스템 고도화

---

## 👨‍💻 제작 팀

**Team GRIT**
- 최지웅 (기획, 백엔드, GPT 파인튜닝)
- 안성환 (시장조사, 프론트 UI, 사용자 인터뷰)

---

## 📄 라이선스

MIT License. 자유롭게 사용 및 수정하되, 출처를 남겨주세요.

---

> "조건을 읽고, 감성까지 추천합니다."
> 
> — Com.On
____
## 🤖 Tech TMI (개발 회고)

Com.On을 약 2주간 운영하며 약 500명의 사용자를 유입시켰지만, 재방문율은 낮았습니다. 단순한 마케팅보다는 **“사용자가 진짜 만족했는가?”**에 대한 근본적 질문이 남았습니다. 아래는 개발 및 운영 중 경험한 기술적 한계와 개선 아이디어를 기록한 섹션입니다.

---

### 🧱 1. 코드 구조와 유지보수
- JS와 HTML 하드코딩은 GPT의 도움을 받기엔 유리했지만, **유지보수가 어려운 구조**였습니다.
- HTML/JS/CSS가 분리되지 않았고, 일부는 `n8n`에서 동적으로 코드를 불러오는 방식으로 **안정성과 확장성이 낮음**.
- UI/UX 수정 난이도가 매우 높았고, 메인 UI는 대화형 인터페이스임에도 불구하고 직관성이 떨어졌습니다. 실제 유저가 “안녕~”처럼 인사로 검색하는 사례도 있었습니다.

---

### 🚀 2. 서버 및 배포
- Render를 사용하며 **15분간 접속이 없으면 서버가 꺼지는 구조**가 매우 불편했고, `UptimeRobot`으로 우회 중입니다.
- Docker 도입 후 배포 시간이 길어졌으며, **Render 파이프라인 비용/속도** 관련 원인 파악이 필요합니다.
- 개발용 서버와 배포용 서버를 GitHub / Render / n8n으로 따로 구성 중인데, 보다 효율적인 구조 도입이 필요합니다.

---

### 📊 3. 데이터 수집 및 분석
- 사용자 행동을 분석할 수 있는 도구가 전무합니다. 현재는 단순 로그를 수동으로 수집 및 분석하고 있습니다.
- 이어검색 사용률, 첫검색 대비 반응 등은 **모두 수작업 메타 기반**으로 파악 중입니다.
- GA4 / GTM은 설정만 되어 있고 **제대로 활용하지 못하고 있음**. 원하는 이벤트 UI를 맞춤형 GA4 보고서로 구성하는 작업이 필요합니다.

---

### 🧠 4. 결과 생성 및 프롬프트
- GPT 기반 결과카드 생성은 `n8n` 프롬프트 엔지니어링이 까다로웠습니다.
- temperature 조절 등으로 일부 품질 개선은 되었지만, 여전히 **속도가 느리고, 안정성 없으며, API Key 소모가 큼**.
- 결국 가장 이상적인 구조는 **데이터베이스 기반의 응답 캐싱 및 서빙**이라고 판단됩니다.

---

### 🗃️ 5. 데이터베이스 구조
- 현재는 DB를 사용하지 않고 있으며, 응답은 JSON 형태로만 처리 중입니다.
- DB 비도입은 초기 MVP 구조로서는 장점이나, **속도와 기능적 확장성 측면에서 병목**으로 작용하고 있습니다.
- 추후 검색 결과 저장 및 응답 속도 향상을 위해 DB 도입 검토가 필요합니다.

---

### 🖼️ 6. API 및 이미지 처리
- 제품 정보는 Naver Shopping API 기반이나, 이미지 검색은 별도 이미지 검색 API 사용 중 → **실제 제품 이미지와 차이 발생**.
- 자동차와 같이 Naver 쇼핑에서 직접 판매하지 않는 품목은 없다고 안내해야 하나, 현재는 유사도 1위 추천으로 **부품 등 엉뚱한 결과** 출력됨.

---

### 🔍 7. SEO 및 광고
- Naver Search Advisor는 성공적으로 설정되었지만, Google Search Console은 **색인 생성 실패**.
- SEO 최적화가 부족하여 **검색 시 노출이 제한적**이며, 오히려 GitHub 리포가 더 먼저 뜨는 상황.
- Google Ads 키워드 효율이 낮아 **클릭 3건 중 한 건당 800원 비용 발생**, 키워드 재조정이 필요함.

---

### 🛠️ 8. 기술 스택 고찰
- 현재는 Flask 기반이며, JS에서 API만 호출하는 수준이기에 **불필요한 라이브러리 포함**.
- FastAPI 등으로의 경량화도 고려 중.
- 외부 Open API 키를 사용 중이며, **보안 및 유지보수 측면에서 자체 키 전환 필요**.

---

### ⚠️ 9. 시스템 안정성
- 6월 10일 GPT 서버 오류로 인해 검색 속도가 **40초 → 1분 40초**까지 늘어난 사례가 있었음.
- 타 서비스 의존성이 높은 구조로, **대응 전략이 필요**. 예: GPT 응답이 느려지면 Gemini 등으로 자동 전환하는 구조.

---

### 🧩 10. 기타
- 현재 API 중심 서비스로 **시장성 부족(의존도 및 비용)** 문제 존재.
- 완전한 리팩토링 및 기술 아키텍처 재정립이 필요합니다.
- **생각날 때마다 업데이트 예정입니다.**
